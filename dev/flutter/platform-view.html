<!DOCTYPE html>
<html lang="th-TH">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ใช้ PlatformView แสดง Native View บน Flutter | Intception Hideout</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="บางครั้งเราอาจจะต้องเขียน Plugin ที่ใช้แสดง View ที่ต้องใช้ความสามารถในฝั่ง Native ด้วย (เช่น Google Maps, Webview, Camera เป็นต้น) ในความโชคดีก็คือหลายๆตัวมันก็มีคนเขียนให้เราใช้ได้เลยแล้วแหละ แต่ถ้าเกิดเราโชคร้ายไม่มีคนเขียนให้เลยเราก็ต้องลงไปลุยเขียนเองครับ">
    <meta name="image" content="https://blog.intception.me/flutter/platform-view.jpg">
    <meta name="twitter:title" content="ใช้ PlatformView แสดง Native View บน Flutter">
    <meta name="twitter:description" content="บางครั้งเราอาจจะต้องเขียน Plugin ที่ใช้แสดง View ที่ต้องใช้ความสามารถในฝั่ง Native ด้วย (เช่น Google Maps, Webview, Camera เป็นต้น) ในความโชคดีก็คือหลายๆตัวมันก็มีคนเขียนให้เราใช้ได้เลยแล้วแหละ แต่ถ้าเกิดเราโชคร้ายไม่มีคนเขียนให้เลยเราก็ต้องลงไปลุยเขียนเองครับ">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://blog.intception.me/flutter/platform-view.jpg">
    <meta name="twitter:url" content="https://blog.intception.me/dev/flutter/platform-view.html">
    <meta property="og:type" content="article">
    <meta property="og:title" content="ใช้ PlatformView แสดง Native View บน Flutter">
    <meta property="og:description" content="บางครั้งเราอาจจะต้องเขียน Plugin ที่ใช้แสดง View ที่ต้องใช้ความสามารถในฝั่ง Native ด้วย (เช่น Google Maps, Webview, Camera เป็นต้น) ในความโชคดีก็คือหลายๆตัวมันก็มีคนเขียนให้เราใช้ได้เลยแล้วแหละ แต่ถ้าเกิดเราโชคร้ายไม่มีคนเขียนให้เลยเราก็ต้องลงไปลุยเขียนเองครับ">
    <meta property="og:image" content="https://blog.intception.me/flutter/platform-view.jpg">
    <meta property="og:url" content="https://blog.intception.me/dev/flutter/platform-view.html">
    <meta property="og:site_name" content="Intception Hideout">
    <meta property="article:author" content="https://www.facebook.com/100002134179036">
    <meta property="article:published_time" content="November 28, 2019 10:00:00">
    <meta property="article:tag" content="dev">
    <meta itemprop="name" content="ใช้ PlatformView แสดง Native View บน Flutter">
    <meta itemprop="description" content="บางครั้งเราอาจจะต้องเขียน Plugin ที่ใช้แสดง View ที่ต้องใช้ความสามารถในฝั่ง Native ด้วย (เช่น Google Maps, Webview, Camera เป็นต้น) ในความโชคดีก็คือหลายๆตัวมันก็มีคนเขียนให้เราใช้ได้เลยแล้วแหละ แต่ถ้าเกิดเราโชคร้ายไม่มีคนเขียนให้เลยเราก็ต้องลงไปลุยเขียนเองครับ">
    <meta itemprop="image" content="https://blog.intception.me/flutter/platform-view.jpg">
    <meta property="fb:app_id" content="378991759371355">
    <meta property="article:publisher" content="https://www.facebook.com/intception">
    
    <link rel="preload" href="/assets/css/0.styles.9fcaea78.css" as="style"><link rel="preload" href="/assets/js/app.e8816fbe.js" as="script"><link rel="preload" href="/assets/js/23.98f77880.js" as="script"><link rel="preload" href="/assets/js/2.5511de28.js" as="script"><link rel="preload" href="/assets/js/9.3d2ae7fe.js" as="script"><link rel="preload" href="/assets/js/30.ceffa3ae.js" as="script"><link rel="preload" href="/assets/js/29.6bb21054.js" as="script"><link rel="preload" href="/assets/js/41.a1cbfaa2.js" as="script"><link rel="prefetch" href="/assets/js/1.7038105b.js"><link rel="prefetch" href="/assets/js/10.93173d2d.js"><link rel="prefetch" href="/assets/js/11.0f9c5f1c.js"><link rel="prefetch" href="/assets/js/12.91b64e47.js"><link rel="prefetch" href="/assets/js/13.08a3a51f.js"><link rel="prefetch" href="/assets/js/14.c8e0a547.js"><link rel="prefetch" href="/assets/js/15.43c6b249.js"><link rel="prefetch" href="/assets/js/16.99ef011c.js"><link rel="prefetch" href="/assets/js/17.b660276a.js"><link rel="prefetch" href="/assets/js/18.7c32fc21.js"><link rel="prefetch" href="/assets/js/19.3aa4ded7.js"><link rel="prefetch" href="/assets/js/20.f9256596.js"><link rel="prefetch" href="/assets/js/21.4dd2eea6.js"><link rel="prefetch" href="/assets/js/22.bebac973.js"><link rel="prefetch" href="/assets/js/24.97336265.js"><link rel="prefetch" href="/assets/js/25.c15aed46.js"><link rel="prefetch" href="/assets/js/26.cdb80987.js"><link rel="prefetch" href="/assets/js/27.061d534a.js"><link rel="prefetch" href="/assets/js/28.a7dedf0a.js"><link rel="prefetch" href="/assets/js/31.4cee5970.js"><link rel="prefetch" href="/assets/js/32.958c025c.js"><link rel="prefetch" href="/assets/js/33.1baa13ba.js"><link rel="prefetch" href="/assets/js/34.d9701686.js"><link rel="prefetch" href="/assets/js/35.25566597.js"><link rel="prefetch" href="/assets/js/36.455eb1cd.js"><link rel="prefetch" href="/assets/js/37.f9701788.js"><link rel="prefetch" href="/assets/js/38.7adbe429.js"><link rel="prefetch" href="/assets/js/39.0e42479f.js"><link rel="prefetch" href="/assets/js/4.d70afffc.js"><link rel="prefetch" href="/assets/js/40.6427dc18.js"><link rel="prefetch" href="/assets/js/42.a1b17ae6.js"><link rel="prefetch" href="/assets/js/43.b629483d.js"><link rel="prefetch" href="/assets/js/44.3ce67008.js"><link rel="prefetch" href="/assets/js/45.58b17ad5.js"><link rel="prefetch" href="/assets/js/46.68e3b49f.js"><link rel="prefetch" href="/assets/js/47.72e2cea9.js"><link rel="prefetch" href="/assets/js/48.2928f898.js"><link rel="prefetch" href="/assets/js/49.94a83419.js"><link rel="prefetch" href="/assets/js/5.dbd44f85.js"><link rel="prefetch" href="/assets/js/6.2ecdc96d.js"><link rel="prefetch" href="/assets/js/7.1abc7760.js"><link rel="prefetch" href="/assets/js/8.47b30f38.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9fcaea78.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div data-v-500e1d8c><div class="theme-container" data-v-500e1d8c><header class="navbar" data-v-500e1d8c><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="Intception Hideout" class="logo"> <span class="site-name can-hide">Intception Hideout</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/dev/" class="nav-link router-link-active">Dev</a></div><div class="nav-item"><a href="/lifestyle/" class="nav-link">Lifestyle</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-500e1d8c></div> <aside class="sidebar" data-v-500e1d8c><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/dev/" class="nav-link router-link-active">Dev</a></div><div class="nav-item"><a href="/lifestyle/" class="nav-link">Lifestyle</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>ใช้ PlatformView แสดง Native View บน Flutter</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/flutter/platform-view.html#เตรียมความพร้อมสิ่งที่ต้องมี" class="sidebar-link">เตรียมความพร้อมสิ่งที่ต้องมี</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/dev/flutter/platform-view.html#สร้างโปรเจค-flutter-plugin" class="sidebar-link">สร้างโปรเจค Flutter Plugin</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/dev/flutter/platform-view.html#เริ่มเขียน-plugin" class="sidebar-link">เริ่มเขียน Plugin</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/dev/flutter/platform-view.html#เขียน-plugin-ในฝั่ง-flutter" class="sidebar-link">เขียน Plugin ในฝั่ง Flutter</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dev/flutter/platform-view.html#สร้าง-widget" class="sidebar-link">สร้าง Widget</a></li><li class="sidebar-sub-header"><a href="/dev/flutter/platform-view.html#กําหนดค่าเริ่มต้นให้กับ-widget" class="sidebar-link">กำหนดค่าเริ่มต้นให้กับ Widget</a></li><li class="sidebar-sub-header"><a href="/dev/flutter/platform-view.html#ตั้งค่าเพื่อให้เราสามารถควบคุม-widget-หรือ-view-ในภายหลัง" class="sidebar-link">ตั้งค่าเพื่อให้เราสามารถควบคุม Widget หรือ View ในภายหลัง</a></li><li class="sidebar-sub-header"><a href="/dev/flutter/platform-view.html#สุดท้ายโค้ดของเราในฝั่ง-flutter-ครับ" class="sidebar-link">สุดท้ายโค้ดของเราในฝั่ง Flutter ครับ</a></li></ul></li><li><a href="/dev/flutter/platform-view.html#ฝั่ง-native-ที่เขียนด้วย-kotlin" class="sidebar-link">ฝั่ง Native ที่เขียนด้วย kotlin</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dev/flutter/platform-view.html#เขียน-plugin" class="sidebar-link">เขียน Plugin</a></li><li class="sidebar-sub-header"><a href="/dev/flutter/platform-view.html#เขียน-platformviewfactory-ไว้ใช้สร้าง-platformview" class="sidebar-link">เขียน PlatformViewFactory ไว้ใช้สร้าง PlatformView</a></li><li class="sidebar-sub-header"><a href="/dev/flutter/platform-view.html#เขียน-platformview" class="sidebar-link">เขียน PlatformView</a></li><li class="sidebar-sub-header"><a href="/dev/flutter/platform-view.html#สรุปโค้ดฝั่ง-native" class="sidebar-link">สรุปโค้ดฝั่ง Native</a></li></ul></li><li><a href="/dev/flutter/platform-view.html#มาเขียนไฟล์-example-กันครับ" class="sidebar-link">มาเขียนไฟล์ Example กันครับ</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/dev/flutter/platform-view.html#เอา-plugin-มาใช้งานจริง" class="sidebar-link">เอา Plugin มาใช้งานจริง</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/dev/flutter/platform-view.html#สรุป" class="sidebar-link">สรุป</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page" data-v-500e1d8c> <div class="theme-default-content content__default"><h1 id="ใช้-platformview-แสดง-native-view-บน-flutter"><a href="#ใช้-platformview-แสดง-native-view-บน-flutter" class="header-anchor">#</a> ใช้ PlatformView แสดง Native View บน Flutter</h1> <span data-v-11962d9e><a href="/?tag=dev" class="tag-element" data-v-eeb2ca7e data-v-11962d9e>#Dev</a><a href="/?tag=flutter" class="tag-element" data-v-eeb2ca7e data-v-11962d9e>#Flutter</a><a href="/?tag=plugin" class="tag-element" data-v-eeb2ca7e data-v-11962d9e>#Plugin</a></span> <p>บางครั้งเราอาจจะต้องเขียน Plugin ที่ใช้แสดง View ที่ต้องใช้ความสามารถในฝั่ง Native ด้วย (เช่น Google Maps, Webview, Camera เป็นต้น) ในความโชคดีก็คือหลายๆตัวมันก็มีคนเขียนให้เราใช้ได้เลยแล้วแหละ แต่ถ้าเกิดเราโชคร้ายไม่มีคนเขียนให้เลยเราก็ต้องลงไปลุยเขียนเองครับ</p> <p>ซึ่งแน่นอนว่าการจะเขียนได้นั้นต้องพอมีความรู้ในการเขียน Native สักนิดสักหน่อย ไม่ว่าจะเป็นภาษา Kotlin (Android) หรือ Swift (iOS) ซึ่งผมพอเข้าใจ Kotlin บ้างเล็กน้อย...ส่วน Swift นี่ไม่รู้เรื่องเลย 🤣<br>
ในบทความนี้จะสอนวิธีเขียนตั้งแต่ต้น และพยายามอธิบายให้เข้าใจเขียนเองได้ครับ</p> <img src="/assets/img/00.f6a68403.jpg" alt="Header"><h2 id="เตรียมความพร้อมสิ่งที่ต้องมี"><a href="#เตรียมความพร้อมสิ่งที่ต้องมี" class="header-anchor">#</a> เตรียมความพร้อมสิ่งที่ต้องมี</h2> <ul><li>Android Studio ที่ติดตั้ง Flutter Plugin แล้ว</li> <li>ความรู้พื้นฐานในการเขียน Plugin ผมเคยเขียนไว้แล้วครับที่บทความนี้ <a href="/dev/flutter/simple-plugin">Simple Plugin</a> แต่จะไม่อ่านก็ไม่น่าจะเป็นอะไร เพราะไม่ได้ลงลึก</li></ul> <h2 id="สร้างโปรเจค-flutter-plugin"><a href="#สร้างโปรเจค-flutter-plugin" class="header-anchor">#</a> สร้างโปรเจค Flutter Plugin</h2> <p>เปิด Android Studio ขึ้นมาแล้วกดสร้างโปรเจค Flutter</p> <center class="medium-zoom"><div class="force-max"><img src="data:image/png;base64,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" alt="Title"></div> <div class="caption">สร้างโปรเจค Flutter</div></center> <p>เลือกสร้าง Flutter Plugin</p> <center class="medium-zoom"><div class="force-max"><img src="/assets/img/02.ab4c8eff.png" alt="Title"></div></center> <p>ในที่นี้ผมจะทำ Plugin สร้าง TextView (ซึ่งก็เหมือนกับ Text Widget ของ Flutter นั่นแหละ)</p> <center class="medium-zoom"><div class="force-max"><img src="/assets/img/03.11fc0f05.png" alt="Title"></div> <div class="caption">ชื่อโปรเจคก็ตั้งง่ายๆแบบนี้ล่ะ</div></center> <p>ที่สำคัญคืออย่าลืมติ๊ก Kotlin เพราะเราจะเขียนด้วย Kotlin เสร็จแล้วก็ Finish ได้เลยครับ</p> <center class="medium-zoom"><div class="force-max"><img src="/assets/img/04.4d534fcd.png" alt="Title"></div></center> <p>คลิกเลือกไฟล์ <code>example/lib/main.dart</code> แล้วลองรันดู จะต้องได้โปรแกรมหน้าตาตามนี้</p> <center class="medium-zoom"><div class="force-max" style="max-width:50%;"><img src="/assets/img/05.bc5bd726.png" alt="Title"></div></center> <h2 id="เริ่มเขียน-plugin"><a href="#เริ่มเขียน-plugin" class="header-anchor">#</a> เริ่มเขียน Plugin</h2> <p>ไฟล์ที่เราสนใจจะมี <code>lib/textview.dart</code> ที่เป็นไฟล์ของ Plugin ในฝั่ง Flutter แล้วก็ไฟล์ <code>android/src/main/.../TextviewPlugin.kt</code> เป็นไฟล์ Plugin ในฝั่ง Native Android แล้วก็ไฟล์ <code>example/lib/main.dart</code> ที่เป็นไฟล์สำหรับใช้เขียนตัวอย่างการใช้งานของ Plugin ของเรา ส่วนไฟล์ <code>test/textview_test.dart</code> เป็นไฟล์ทำ Testing ก็เอาเท่าที่สะดวกเลยครับ 🤣</p> <h2 id="เขียน-plugin-ในฝั่ง-flutter"><a href="#เขียน-plugin-ในฝั่ง-flutter" class="header-anchor">#</a> เขียน Plugin ในฝั่ง Flutter</h2> <p>เริ่มกันโดยเขียนโค้ด Plugin ฝั่ง Flutter กันก่อนครับ ซึ่งเราจะเริ่มจากการสร้าง Widget กันก่อน<br>
คนที่ต้องการใช้ Plugin ของเราก็จะต้องมาเรียกเจ้า Widget ที่เราสร้างขึ้นมานี่ล่ะครับ</p> <h3 id="สร้าง-widget"><a href="#สร้าง-widget" class="header-anchor">#</a> สร้าง Widget</h3> <p><code>lib/textview.dart</code></p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string">'package:flutter/foundation.dart'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'package:flutter/widgets.dart'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">TextView</span> <span class="token keyword">extends</span> <span class="token class-name">StatefulWidget</span> <span class="token punctuation">{</span>
  <span class="token metadata symbol">@override</span>
  _TextViewState <span class="token function">createState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">_TextViewState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">_TextViewState</span> <span class="token keyword">extends</span> <span class="token class-name">State</span><span class="token operator">&lt;</span>TextView<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token metadata symbol">@override</span>
  Widget <span class="token function">build</span><span class="token punctuation">(</span>BuildContext context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// defaultTargetPlatform มาจาก library ที่ชื่อ foundation.dart</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>defaultTargetPlatform<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> TargetPlatform<span class="token punctuation">.</span>android<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token function">AndroidView</span><span class="token punctuation">(</span>
          viewType<span class="token punctuation">:</span> <span class="token string">'me.intception.textview'</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> TargetPlatform<span class="token punctuation">.</span>iOS<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token function">UiKitView</span><span class="token punctuation">(</span>
          viewType<span class="token punctuation">:</span> <span class="token string">'me.intception.textview'</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">default</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token function">Text</span><span class="token punctuation">(</span><span class="token string">'$defaultTargetPlatform is not supported'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>จากไฟล์ข้างต้นเรา ผมได้สร้าง <strong>Stateful Widget</strong> ไว้หนึ่งตัวชื่อ <strong>TextView</strong>
สิ่งที่ Widget ตัวนี้ build หรือสร้างขึ้นมาก็คือ Widget ที่ชื่อ <strong>AndroidView</strong> เมื่อเรา Build แอปสำหรับ Android หรือ <strong>UiKitView</strong> เมื่อเรา Build แอปสำหรับ iOS และเราก็ใส่ <strong>default</strong> ไว้เผื่อ Plugin ถูกเอาไปใช้ที่อื่น</p> <p>โดยค่าที่เราจะส่งเข้าไปใน <strong>AndroidView</strong> หรือ <strong>UiKitView</strong> นั้นจะเป็นชื่อของ View ที่เรากำลังจะสร้างในภายหลังในฝั่ง Native ครับ<br>
โดยผมตั้งชื่อในรูปแบบนี้เพื่อไม่ให้เกิดการซ้ำกับชื่อ View ของคนอื่น กรณีที่ชื่อ Plugin ของเราโหลเกินครับ</p> <div class="warning custom-block"><p>แต่ในที่นี้ผมจะ Comment ในส่วนของ iOS ไปนะครับ<br>
เพราะผมเขียน Native ฝั่ง iOS ไม่เป็น 😂</p></div> <h3 id="กําหนดค่าเริ่มต้นให้กับ-widget"><a href="#กําหนดค่าเริ่มต้นให้กับ-widget" class="header-anchor">#</a> กำหนดค่าเริ่มต้นให้กับ Widget</h3> <p>และแน่นอน เมื่อเรากำลังจะสร้าง TextView เพื่อแสดง String หรือ Text<br>
Widget TextView ของเรานั้นก็ต้องรับค่า String เพื่อมาใช้แสดงด้วยครับ</p> <div class="language-dart extra-class"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br></div><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string">'package:flutter/foundation.dart'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'package:flutter/services.dart'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'package:flutter/widgets.dart'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">TextView</span> <span class="token keyword">extends</span> <span class="token class-name">StatefulWidget</span> <span class="token punctuation">{</span>
  <span class="token keyword">final</span> String defaultText<span class="token punctuation">;</span>

  <span class="token function">TextView</span><span class="token punctuation">(</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>defaultText<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    Key key<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token metadata symbol">@override</span>
  _TextViewState <span class="token function">createState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">_TextViewState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">_TextViewState</span> <span class="token keyword">extends</span> <span class="token class-name">State</span><span class="token operator">&lt;</span>TextView<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token metadata symbol">@override</span>
  Widget <span class="token function">build</span><span class="token punctuation">(</span>BuildContext context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// defaultTargetPlatform มาจาก library ที่ชื่อ foundation.dart</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>defaultTargetPlatform<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> TargetPlatform<span class="token punctuation">.</span>android<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token function">AndroidView</span><span class="token punctuation">(</span>
          viewType<span class="token punctuation">:</span> <span class="token string">'me.intception.textview'</span><span class="token punctuation">,</span>
          creationParamsCodec<span class="token punctuation">:</span> <span class="token function">StandardMessageCodec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          creationParams<span class="token punctuation">:</span> widget<span class="token punctuation">.</span>defaultText<span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> TargetPlatform<span class="token punctuation">.</span>iOS<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token function">UiKitView</span><span class="token punctuation">(</span>
          viewType<span class="token punctuation">:</span> <span class="token string">'me.intception.textview'</span><span class="token punctuation">,</span>
          creationParamsCodec<span class="token punctuation">:</span> <span class="token function">StandardMessageCodec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          creationParams<span class="token punctuation">:</span> widget<span class="token punctuation">.</span>defaultText<span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">default</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token function">Text</span><span class="token punctuation">(</span><span class="token string">'$defaultTargetPlatform is not supported'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ในที่นี้ผมก็ได้เพิ่ม <strong>creationParams</strong> เข้าไปครับ แต่เมื่อเรากำหนดค่านี้แล้วเราจำเป็นต้องตั้งค่า <strong>creationParamsCodec</strong> ด้วย<br>
ค่าที่กำหนดก็แล้วแต่เลยครับ int, String, Array หรือจะอะไรก็แล้วเราจะส่งเลยครับ ซึ่งค่านี้จะถูกเอาไปใช้ตอนที่เราสร้าง View ในฝั่ง Native</p> <div class="tip custom-block"><p>ถ้า Plugin เราง่ายๆแค่แสดง Text เฉยๆ แสดงค่าเฉยๆ เราสามารถจบโค้ดในฝั่ง Flutter ได้ที่ตรงนี้เลยครับ</p></div> <h3 id="ตั้งค่าเพื่อให้เราสามารถควบคุม-widget-หรือ-view-ในภายหลัง"><a href="#ตั้งค่าเพื่อให้เราสามารถควบคุม-widget-หรือ-view-ในภายหลัง" class="header-anchor">#</a> ตั้งค่าเพื่อให้เราสามารถควบคุม Widget หรือ View ในภายหลัง</h3> <p>แน่นอนผมไม่จบแค่ตั้งค่า Text แล้วจบหรอก ในขั้นตอนถัดไปผมจะเพิ่ม Controller เพื่อที่จะควบคุมตัว View กันครับ</p> <p><code>lib/textview.dart</code></p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token comment">// Controller อันนี้สร้างไว้เพื่อที่จะทำให้เราสามารถควบคุม View ในฝั่ง Native ได้</span>
<span class="token keyword">class</span> <span class="token class-name">TextViewController</span> <span class="token punctuation">{</span>
  MethodChannel _channel<span class="token punctuation">;</span>

  <span class="token function">TextViewController</span><span class="token punctuation">(</span>int id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _channel <span class="token operator">=</span> <span class="token function">MethodChannel</span><span class="token punctuation">(</span><span class="token string">'me.intception.textview/$id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// invokeMethod คืนค่าเป็น Future เราจึงต้องใส่ async ไว้ด้วย</span>
  Future<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span> <span class="token function">setText</span><span class="token punctuation">(</span>String newText<span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    <span class="token keyword">assert</span><span class="token punctuation">(</span>newText <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _channel<span class="token punctuation">.</span><span class="token function">invokeMethod</span><span class="token punctuation">(</span><span class="token string">'setText'</span><span class="token punctuation">,</span> newText<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><p>ตอนนี้ผมสร้าง <strong>TextViewController</strong> ขึ้นมาครับ เพื่อใช้ควบคุม View ของเรา<br>
ในที่นี้ผมก็จะกำหนดให้ผู้ใช้ Plugin สามารถใช้ setText เพื่อเปลี่ยน Text ในภายหลังได้ครับ<br>
สิ่งสำคัญของ Controller ของเราที่จะต้องมีก็คือการกำหนด MethodChannel เพื่อติดต่อกับ View ที่กำลังจะถูกสร้างขึ้นมา</p> <div class="tip custom-block"><p>View แต่ละตัวจะมี Controller ควบคุมแยกกัน โดยหลังจากที่เราสั่งให้สร้าง View ขึ้นมาจะมีการคืนค่า id ออกมาด้วย เราสามารถใช้ค่านี้ในการกำหนด channel การเชื่อมต่อของเราได้</p></div> <div class="language-dart extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br></div><pre class="language-dart"><code><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">class</span> <span class="token class-name">TextView</span> <span class="token keyword">extends</span> <span class="token class-name">StatefulWidget</span> <span class="token punctuation">{</span>
  <span class="token keyword">final</span> String defaultText<span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token keyword">Function</span> onCreated<span class="token punctuation">;</span>

  <span class="token function">TextView</span><span class="token punctuation">(</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>defaultText<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    Key key<span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>onCreated
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token metadata symbol">@override</span>
  _TextViewState <span class="token function">createState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">_TextViewState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">_TextViewState</span> <span class="token keyword">extends</span> <span class="token class-name">State</span><span class="token operator">&lt;</span>TextView<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">void</span> <span class="token function">onPlatFormViewCreated</span><span class="token punctuation">(</span>int id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>widget<span class="token punctuation">.</span>onCreated <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    widget<span class="token punctuation">.</span><span class="token function">onCreated</span><span class="token punctuation">(</span><span class="token function">TextViewController</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token metadata symbol">@override</span>
  Widget <span class="token function">build</span><span class="token punctuation">(</span>BuildContext context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// defaultTargetPlatform มาจาก library ที่ชื่อ foundation.dart</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>defaultTargetPlatform<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> TargetPlatform<span class="token punctuation">.</span>android<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token function">AndroidView</span><span class="token punctuation">(</span>
          viewType<span class="token punctuation">:</span> <span class="token string">'me.intception.textview'</span><span class="token punctuation">,</span>
          creationParamsCodec<span class="token punctuation">:</span> <span class="token function">StandardMessageCodec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          creationParams<span class="token punctuation">:</span> widget<span class="token punctuation">.</span>defaultText<span class="token punctuation">,</span>
          onPlatformViewCreated<span class="token punctuation">:</span> onPlatFormViewCreated<span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> TargetPlatform<span class="token punctuation">.</span>iOS<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token function">UiKitView</span><span class="token punctuation">(</span>
          viewType<span class="token punctuation">:</span> <span class="token string">'me.intception.textview'</span><span class="token punctuation">,</span>
          creationParamsCodec<span class="token punctuation">:</span> <span class="token function">StandardMessageCodec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          creationParams<span class="token punctuation">:</span> widget<span class="token punctuation">.</span>defaultText<span class="token punctuation">,</span>
          onPlatformViewCreated<span class="token punctuation">:</span> onPlatFormViewCreated<span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">default</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token function">Text</span><span class="token punctuation">(</span><span class="token string">'$defaultTargetPlatform is not supported'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ในส่วนนี้ผมได้เพิ่ม <strong>onPlatformViewCreated</strong> เข้ามาครับ เป็น Callback ที่จะถูกทำงานเมื่อ View ถูกสร้างเสร็จแล้ว โดยมันจะส่ง Parameter ที่เป็น int มาให้ด้วยครับ ในที่นี้ผมก็เอาไปสร้าง Controller ของผม<br>
ผู้ใช้ Plugin จะต้องส่ง Callback Function ใส่ <strong>onCreated</strong> เพื่อที่จะรอรับ Controller ของผมด้วย (หากต้องการ)</p> <p>ทีนี้มันจะมีปัญหานิดหนึ่งครับ ตรงที่ถ้าเราเขียน <code>final Function onCreated;</code> ลงไป คนที่เรียกใช้จะเห็น Autocomplete ของ <strong>onCreated</strong> ว่าให้ส่งมาเป็น Function แต่เค้าจะไม่รู้ว่าเรากำหนด Parameter อะไรให้</p> <p>ผมสามารถแก้ไขโดยเปลี่ยนเป็น ตามนี้แทนครับ</p> <div class="language-dart extra-class"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-dart"><code><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">typedef</span> <span class="token keyword">void</span> <span class="token function">TextViewCreated</span><span class="token punctuation">(</span>TextViewController controller<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">TextViewController</span> <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">TextView</span> <span class="token keyword">extends</span> <span class="token class-name">StatefulWidget</span> <span class="token punctuation">{</span>
  <span class="token keyword">final</span> String defaultText<span class="token punctuation">;</span>
  <span class="token keyword">final</span> TextViewCreated onCreated<span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><p>typedef เป็นการกำหนด type ใหม่ขึ้นมาในที่นี้ <strong>TextViewCreated</strong> คือเป็น Type ใหม่ที่หน้าตาเป็น Function แต่มีการกำหนดเลยว่า Function นี้จะคืนค่าเป็น void (ไม่คืนค่า) และจะมีการส่ง Controller กลับไปที่มีหน้าตาเป็น <strong>TextViewController</strong> ที่เราสร้างไว้</p> <h3 id="สุดท้ายโค้ดของเราในฝั่ง-flutter-ครับ"><a href="#สุดท้ายโค้ดของเราในฝั่ง-flutter-ครับ" class="header-anchor">#</a> สุดท้ายโค้ดของเราในฝั่ง Flutter ครับ</h3> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string">'package:flutter/foundation.dart'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'package:flutter/services.dart'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'package:flutter/widgets.dart'</span><span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token keyword">void</span> <span class="token function">TextViewCreated</span><span class="token punctuation">(</span>TextViewController controller<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Controller อันนี้สร้างไว้เพื่อที่จะทำให้เราสามารถควบคุม View ในฝั่ง Native ได้</span>
<span class="token keyword">class</span> <span class="token class-name">TextViewController</span> <span class="token punctuation">{</span>
  MethodChannel _channel<span class="token punctuation">;</span>

  <span class="token function">TextViewController</span><span class="token punctuation">(</span>int id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _channel <span class="token operator">=</span> <span class="token function">MethodChannel</span><span class="token punctuation">(</span><span class="token string">'me.intception.textview/$id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// invokeMethod คืนค่าเป็น Future เราจึงต้องใส่ async ไว้ด้วย</span>
  Future<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span> <span class="token function">setText</span><span class="token punctuation">(</span>String newText<span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    <span class="token keyword">assert</span><span class="token punctuation">(</span>newText <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _channel<span class="token punctuation">.</span><span class="token function">invokeMethod</span><span class="token punctuation">(</span><span class="token string">'setText'</span><span class="token punctuation">,</span> newText<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">TextView</span> <span class="token keyword">extends</span> <span class="token class-name">StatefulWidget</span> <span class="token punctuation">{</span>
  <span class="token keyword">final</span> String defaultText<span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token keyword">Function</span> onCreated<span class="token punctuation">;</span>

  <span class="token function">TextView</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>defaultText<span class="token punctuation">,</span> <span class="token punctuation">{</span>Key key<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onCreated<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token metadata symbol">@override</span>
  _TextViewState <span class="token function">createState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">_TextViewState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">_TextViewState</span> <span class="token keyword">extends</span> <span class="token class-name">State</span><span class="token operator">&lt;</span>TextView<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">void</span> <span class="token function">onPlatFormViewCreated</span><span class="token punctuation">(</span>int id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>widget<span class="token punctuation">.</span>onCreated <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    widget<span class="token punctuation">.</span><span class="token function">onCreated</span><span class="token punctuation">(</span><span class="token function">TextViewController</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token metadata symbol">@override</span>
  Widget <span class="token function">build</span><span class="token punctuation">(</span>BuildContext context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// defaultTargetPlatform มาจาก library ที่ชื่อ foundation.dart</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>defaultTargetPlatform<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> TargetPlatform<span class="token punctuation">.</span>android<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token function">AndroidView</span><span class="token punctuation">(</span>
          viewType<span class="token punctuation">:</span> <span class="token string">'me.intception.textview'</span><span class="token punctuation">,</span>
          creationParamsCodec<span class="token punctuation">:</span> <span class="token function">StandardMessageCodec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          creationParams<span class="token punctuation">:</span> widget<span class="token punctuation">.</span>defaultText<span class="token punctuation">,</span>
          onPlatformViewCreated<span class="token punctuation">:</span> onPlatFormViewCreated<span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> TargetPlatform<span class="token punctuation">.</span>iOS<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token function">UiKitView</span><span class="token punctuation">(</span>
          viewType<span class="token punctuation">:</span> <span class="token string">'me.intception.textview'</span><span class="token punctuation">,</span>
          creationParamsCodec<span class="token punctuation">:</span> <span class="token function">StandardMessageCodec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          creationParams<span class="token punctuation">:</span> widget<span class="token punctuation">.</span>defaultText<span class="token punctuation">,</span>
          onPlatformViewCreated<span class="token punctuation">:</span> onPlatFormViewCreated<span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">default</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token function">Text</span><span class="token punctuation">(</span><span class="token string">'$defaultTargetPlatform is not supported'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="ฝั่ง-native-ที่เขียนด้วย-kotlin"><a href="#ฝั่ง-native-ที่เขียนด้วย-kotlin" class="header-anchor">#</a> ฝั่ง Native ที่เขียนด้วย kotlin</h2> <p>ก่อนที่จะเริ่มเขียน Kotlin นั้น เราต้องเปิด Project Android ขึ้นมาก่อนครับ โดยการคลิกขวาที่โฟลเดอร์ <strong>android</strong> &gt; <strong>Flutter</strong> &gt; <strong>Open Android module in Android Studio</strong> &gt; <strong>New Window</strong></p> <center class="medium-zoom"><div class="force-max"><img src="/assets/img/06.3006f5f2.png" alt="Title"></div></center> <center class="medium-zoom"><div class="force-max"><img src="/assets/img/07.efdf5219.png" alt="Title"></div> <div class="caption">อย่าลืมเปลี่ยนตรงนี้ให้เป็น Android ครับ</div></center> <h3 id="เขียน-plugin"><a href="#เขียน-plugin" class="header-anchor">#</a> เขียน Plugin</h3> <p><code>TextviewPlugin.kt</code></p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token keyword">package</span> me<span class="token punctuation">.</span>intception<span class="token punctuation">.</span>textview

<span class="token keyword">import</span> io<span class="token punctuation">.</span>flutter<span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>common<span class="token punctuation">.</span>PluginRegistry<span class="token punctuation">.</span>Registrar

<span class="token keyword">class</span> TextviewPlugin <span class="token punctuation">{</span>
    <span class="token keyword">companion</span> <span class="token keyword">object</span> <span class="token punctuation">{</span>
        <span class="token annotation builtin">@JvmStatic</span>
        <span class="token keyword">fun</span> <span class="token function">registerWith</span><span class="token punctuation">(</span>registrar<span class="token operator">:</span> Registrar<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            registrar
                <span class="token punctuation">.</span><span class="token function">platformViewRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">registerViewFactory</span><span class="token punctuation">(</span><span class="token string">&quot;me.intception.textview&quot;</span><span class="token punctuation">,</span> <span class="token function">TextviewFactory</span><span class="token punctuation">(</span>registrar<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>จากโค้ดเบื้องต้นจะมีการกำหนด <strong>PlatformViewFactory</strong> (จะถูกสร้างในขั้นตอนถัดไป)<br>
และมีการกำหนดชื่อให้ฝั่งฝั่ง Flutter สามารถเรียกใช้ได้ในชื่อ <code>me.intception.textview</code></p> <h3 id="เขียน-platformviewfactory-ไว้ใช้สร้าง-platformview"><a href="#เขียน-platformviewfactory-ไว้ใช้สร้าง-platformview" class="header-anchor">#</a> เขียน PlatformViewFactory ไว้ใช้สร้าง PlatformView</h3> <p>สร้างไฟล์ <code>TextviewFactory.kt</code> ข้างๆไฟล์ <code>TextviewPlugin.kt</code></p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token keyword">package</span> me<span class="token punctuation">.</span>intception<span class="token punctuation">.</span>textview

<span class="token keyword">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>Context
<span class="token keyword">import</span> io<span class="token punctuation">.</span>flutter<span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>common<span class="token punctuation">.</span>PluginRegistry<span class="token punctuation">.</span>Registrar
<span class="token keyword">import</span> io<span class="token punctuation">.</span>flutter<span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>common<span class="token punctuation">.</span>StandardMessageCodec
<span class="token keyword">import</span> io<span class="token punctuation">.</span>flutter<span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>platform<span class="token punctuation">.</span>PlatformView
<span class="token keyword">import</span> io<span class="token punctuation">.</span>flutter<span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>platform<span class="token punctuation">.</span>PlatformViewFactory

<span class="token keyword">class</span> <span class="token function">TextviewFactory</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">val</span> registrar<span class="token operator">:</span> Registrar<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">PlatformViewFactory</span><span class="token punctuation">(</span><span class="token function">StandardMessageCodec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">create</span><span class="token punctuation">(</span>context<span class="token operator">:</span> Context<span class="token punctuation">,</span> viewId<span class="token operator">:</span> Int<span class="token punctuation">,</span> args<span class="token operator">:</span> Any<span class="token operator">?</span><span class="token punctuation">)</span><span class="token operator">:</span> PlatformView <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">MyTextview</span><span class="token punctuation">(</span>registrar<span class="token punctuation">,</span> viewId<span class="token punctuation">,</span> args<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>สิ่งที่ <strong>PlatformViewFactory</strong> ที่ทำคือมันจะสร้าง PlatformView ให้เราเมื่อ <strong>AndroidView</strong> ในฝั่ง Flutter บอก<br>
และ <strong>MyTextview</strong> นั้นเราจะเขียนในขั้นตอนถัดไปครับ</p> <h3 id="เขียน-platformview"><a href="#เขียน-platformview" class="header-anchor">#</a> เขียน PlatformView</h3> <p>สร้างไฟล์ <code>MyTextview.kt</code> ข้างๆไฟล์ <code>TextviewPlugin.kt</code></p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token keyword">package</span> me<span class="token punctuation">.</span>intception<span class="token punctuation">.</span>textview

<span class="token keyword">import</span> android<span class="token punctuation">.</span>view<span class="token punctuation">.</span>View
<span class="token keyword">import</span> io<span class="token punctuation">.</span>flutter<span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>common<span class="token punctuation">.</span>MethodCall
<span class="token keyword">import</span> io<span class="token punctuation">.</span>flutter<span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>common<span class="token punctuation">.</span>MethodChannel<span class="token punctuation">.</span>MethodCallHandler
<span class="token keyword">import</span> io<span class="token punctuation">.</span>flutter<span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>common<span class="token punctuation">.</span>MethodChannel<span class="token punctuation">.</span>Result
<span class="token keyword">import</span> io<span class="token punctuation">.</span>flutter<span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>common<span class="token punctuation">.</span>PluginRegistry<span class="token punctuation">.</span>Registrar
<span class="token keyword">import</span> io<span class="token punctuation">.</span>flutter<span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>platform<span class="token punctuation">.</span>PlatformView

<span class="token keyword">class</span> <span class="token function">MyTextview</span><span class="token punctuation">(</span>registrar<span class="token operator">:</span> Registrar<span class="token punctuation">,</span> viewId<span class="token operator">:</span> Int<span class="token punctuation">,</span> defaultText<span class="token operator">:</span> String<span class="token punctuation">)</span><span class="token operator">:</span> PlatformView<span class="token punctuation">,</span> MethodCallHandler <span class="token punctuation">{</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">getView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> View <span class="token punctuation">{</span>
        <span class="token function">TODO</span><span class="token punctuation">(</span><span class="token string">&quot;not implemented&quot;</span><span class="token punctuation">)</span> <span class="token comment">//To change body of created functions use File | Settings | File Templates.</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">TODO</span><span class="token punctuation">(</span><span class="token string">&quot;not implemented&quot;</span><span class="token punctuation">)</span> <span class="token comment">//To change body of created functions use File | Settings | File Templates.</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onMethodCall</span><span class="token punctuation">(</span>call<span class="token operator">:</span> MethodCall<span class="token punctuation">,</span> result<span class="token operator">:</span> Result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">TODO</span><span class="token punctuation">(</span><span class="token string">&quot;not implemented&quot;</span><span class="token punctuation">)</span> <span class="token comment">//To change body of created functions use File | Settings | File Templates.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>เมื่อสร้างสิ่งที่เราต้อง override มีด้วยกันทั้งหมด 3 อย่าง ก็คือ</p> <ol><li><strong>getView</strong> ใช้คืนค่า View ที่เราต้องการแสดง</li> <li><strong>dispose</strong> ไว้กำหนดตอนที่ PlatformView จะถูกทำลายให้ทำอะไร</li> <li><strong>onMethodCall</strong> ไว้กำหนด MethodCall ถ้าถูกเรียกโดย Controller ฝั่ง Flutter</li></ol> <p>เรามาเริ่มกำหนดค่าในแต่ละส่วนกันครับ</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>view<span class="token punctuation">.</span>Gravity
<span class="token keyword">import</span> android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span>TextView

<span class="token keyword">class</span> MyTextview <span class="token operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> textView<span class="token operator">:</span> TextView <span class="token operator">=</span> <span class="token function">getTextView</span><span class="token punctuation">(</span>registrar<span class="token punctuation">,</span> defaultText<span class="token punctuation">)</span>

    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">getTextView</span><span class="token punctuation">(</span>registrar<span class="token operator">:</span> Registrar<span class="token punctuation">,</span> text<span class="token operator">:</span> String<span class="token punctuation">)</span><span class="token operator">:</span> TextView <span class="token punctuation">{</span>
        <span class="token keyword">val</span> textView <span class="token operator">=</span> <span class="token function">TextView</span><span class="token punctuation">(</span>registrar<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        textView<span class="token punctuation">.</span>text <span class="token operator">=</span> text
        <span class="token comment">// จัด TextView ไว้กึ่งกลางด้วยการตั้งค่า gravity</span>
        textView<span class="token punctuation">.</span>gravity <span class="token operator">=</span> Gravity<span class="token punctuation">.</span>CENTER
        <span class="token keyword">return</span> textView
    <span class="token punctuation">}</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">getView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> View <span class="token punctuation">{</span>
        <span class="token keyword">return</span> textView
    <span class="token punctuation">}</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token operator">..</span><span class="token punctuation">.</span>
</code></pre></div><p>โค้ดด้านบนผมสร้าง <strong>getTextView</strong> ขึ้นมาเพื่อสร้างและกำหนดค่าเริ่มต้นให้กับ <strong>TextView</strong> ใหม่<br>
และในส่วน <strong>dispose</strong> ผมไม่จำเป็นต้องทำลายอะไรก็ปล่อยว่างไปครับ</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token operator">..</span><span class="token punctuation">.</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onMethodCall</span><span class="token punctuation">(</span>call<span class="token operator">:</span> MethodCall<span class="token punctuation">,</span> result<span class="token operator">:</span> Result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">when</span> <span class="token punctuation">(</span>call<span class="token punctuation">.</span>method<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;setText&quot;</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">val</span> text <span class="token operator">=</span> call<span class="token punctuation">.</span>arguments<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                textView<span class="token punctuation">.</span>text <span class="token operator">=</span> text
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token operator">-&gt;</span> result<span class="token punctuation">.</span><span class="token function">notImplemented</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token operator">..</span><span class="token punctuation">.</span>
</code></pre></div><p>อันนี้เป็นการเขียนรอรับการเรียก <strong>invokeMethod</strong> จากฝั่ง Flutter ในที่นี้ก็เขียนไว้แค่ <strong>setText</strong> นี่แหละครับ เรียกเสร็จก็เอาแค่มาเปลี่ยนใน <strong>TextView</strong> ของเราที่สร้างไว้</p> <p>ยังเหลืออีกนิดหนึ่งครับ คือเราต้องกำหนดด้วยว่าจะให้เรียกผ่านมาทาง <strong>MethodChannel</strong> ไหน</p> <div class="language-kotlin extra-class"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br></div><pre class="language-kotlin"><code><span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>flutter<span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>common<span class="token punctuation">.</span>MethodChannel

<span class="token keyword">class</span> MyTextview <span class="token operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> textView<span class="token operator">:</span> TextView <span class="token operator">=</span> <span class="token function">getTextView</span><span class="token punctuation">(</span>registrar<span class="token punctuation">,</span> defaultText<span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> channel <span class="token operator">=</span> <span class="token function">MethodChannel</span><span class="token punctuation">(</span>registrar<span class="token punctuation">.</span><span class="token function">messenger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;me.intception.textview/<span class="token interpolation variable">$viewId</span>&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">init</span> <span class="token punctuation">{</span>
        channel<span class="token punctuation">.</span><span class="token function">setMethodCallHandler</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token operator">..</span><span class="token punctuation">.</span>
</code></pre></div><h3 id="สรุปโค้ดฝั่ง-native"><a href="#สรุปโค้ดฝั่ง-native" class="header-anchor">#</a> สรุปโค้ดฝั่ง Native</h3> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token keyword">package</span> me<span class="token punctuation">.</span>intception<span class="token punctuation">.</span>native_textview

<span class="token keyword">import</span> android<span class="token punctuation">.</span>view<span class="token punctuation">.</span>Gravity
<span class="token keyword">import</span> android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span>TextView
<span class="token keyword">import</span> io<span class="token punctuation">.</span>flutter<span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>common<span class="token punctuation">.</span>MethodCall
<span class="token keyword">import</span> io<span class="token punctuation">.</span>flutter<span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>common<span class="token punctuation">.</span>MethodChannel
<span class="token keyword">import</span> io<span class="token punctuation">.</span>flutter<span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>common<span class="token punctuation">.</span>MethodChannel<span class="token punctuation">.</span>MethodCallHandler
<span class="token keyword">import</span> io<span class="token punctuation">.</span>flutter<span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>common<span class="token punctuation">.</span>PluginRegistry<span class="token punctuation">.</span>Registrar
<span class="token keyword">import</span> io<span class="token punctuation">.</span>flutter<span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>platform<span class="token punctuation">.</span>PlatformView

<span class="token keyword">class</span> <span class="token function">NativeTextView</span><span class="token punctuation">(</span>context<span class="token operator">:</span> Context<span class="token operator">?</span><span class="token punctuation">,</span> registrar<span class="token operator">:</span> Registrar<span class="token punctuation">,</span> id<span class="token operator">:</span> Int<span class="token punctuation">,</span> text<span class="token operator">:</span> String<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token operator">:</span> PlatformView<span class="token punctuation">,</span> MethodCallHandler <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">var</span> channel<span class="token operator">:</span> MethodChannel <span class="token operator">=</span> <span class="token function">MethodChannel</span><span class="token punctuation">(</span>registrar<span class="token punctuation">.</span><span class="token function">messenger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;me.intception/textview_<span class="token interpolation variable">$id</span>&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">var</span> textView<span class="token operator">:</span> TextView <span class="token operator">=</span> <span class="token function">getTextView</span><span class="token punctuation">(</span>registrar<span class="token punctuation">)</span>

    <span class="token keyword">init</span> <span class="token punctuation">{</span>
        textView<span class="token punctuation">.</span>text <span class="token operator">=</span> text
        textView<span class="token punctuation">.</span>gravity <span class="token operator">=</span> Gravity<span class="token punctuation">.</span>CENTER
        channel<span class="token punctuation">.</span><span class="token function">setMethodCallHandler</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">getView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> TextView <span class="token punctuation">{</span>
        <span class="token keyword">return</span> textView
    <span class="token punctuation">}</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onMethodCall</span><span class="token punctuation">(</span>call<span class="token operator">:</span> MethodCall<span class="token punctuation">,</span> result<span class="token operator">:</span> MethodChannel<span class="token punctuation">.</span>Result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">when</span> <span class="token punctuation">(</span>call<span class="token punctuation">.</span>method<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;setText&quot;</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">val</span> text <span class="token operator">=</span> call<span class="token punctuation">.</span>arguments<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                textView<span class="token punctuation">.</span>text <span class="token operator">=</span> text
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token operator">-&gt;</span> result<span class="token punctuation">.</span><span class="token function">notImplemented</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">getTextView</span><span class="token punctuation">(</span>registrar<span class="token operator">:</span> Registrar<span class="token punctuation">)</span><span class="token operator">:</span> TextView <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">TextView</span><span class="token punctuation">(</span>registrar<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="มาเขียนไฟล์-example-กันครับ"><a href="#มาเขียนไฟล์-example-กันครับ" class="header-anchor">#</a> มาเขียนไฟล์ Example กันครับ</h2> <p><code>example/lib/main.dart</code></p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string">'package:flutter/material.dart'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'package:textview/textview.dart'</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">runApp</span><span class="token punctuation">(</span><span class="token function">MyApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyApp</span> <span class="token keyword">extends</span> <span class="token class-name">StatefulWidget</span> <span class="token punctuation">{</span>
  <span class="token metadata symbol">@override</span>
  _MyAppState <span class="token function">createState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">_MyAppState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">_MyAppState</span> <span class="token keyword">extends</span> <span class="token class-name">State</span><span class="token operator">&lt;</span>MyApp<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  TextEditingController _textEditController <span class="token operator">=</span> <span class="token function">TextEditingController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  TextViewController _textViewController<span class="token punctuation">;</span>
  <span class="token metadata symbol">@override</span>
  <span class="token keyword">void</span> <span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token metadata symbol">@override</span>
  Widget <span class="token function">build</span><span class="token punctuation">(</span>BuildContext context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">MaterialApp</span><span class="token punctuation">(</span>
      home<span class="token punctuation">:</span> <span class="token function">Scaffold</span><span class="token punctuation">(</span>
        appBar<span class="token punctuation">:</span> <span class="token function">AppBar</span><span class="token punctuation">(</span>
          title<span class="token punctuation">:</span> <span class="token keyword">const</span> <span class="token function">Text</span><span class="token punctuation">(</span><span class="token string">'Plugin example app'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        body<span class="token punctuation">:</span> <span class="token function">Column</span><span class="token punctuation">(</span>
          children<span class="token punctuation">:</span> <span class="token operator">&lt;</span>Widget<span class="token operator">&gt;</span><span class="token punctuation">[</span>
            <span class="token function">Padding</span><span class="token punctuation">(</span>
              padding<span class="token punctuation">:</span> <span class="token keyword">const</span> EdgeInsets<span class="token punctuation">.</span><span class="token function">symmetric</span><span class="token punctuation">(</span>horizontal<span class="token punctuation">:</span> <span class="token number">8.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              child<span class="token punctuation">:</span> <span class="token function">Row</span><span class="token punctuation">(</span>
                mainAxisAlignment<span class="token punctuation">:</span> MainAxisAlignment<span class="token punctuation">.</span>spaceAround<span class="token punctuation">,</span>
                mainAxisSize<span class="token punctuation">:</span> MainAxisSize<span class="token punctuation">.</span>max<span class="token punctuation">,</span>
                children<span class="token punctuation">:</span> <span class="token operator">&lt;</span>Widget<span class="token operator">&gt;</span><span class="token punctuation">[</span>
                  <span class="token function">Expanded</span><span class="token punctuation">(</span>
                    child<span class="token punctuation">:</span> <span class="token function">TextField</span><span class="token punctuation">(</span>
                      controller<span class="token punctuation">:</span> _textEditController<span class="token punctuation">,</span>
                    <span class="token punctuation">)</span><span class="token punctuation">,</span>
                  <span class="token punctuation">)</span><span class="token punctuation">,</span>
                  <span class="token function">SizedBox</span><span class="token punctuation">(</span>
                    width<span class="token punctuation">:</span> <span class="token number">10.0</span><span class="token punctuation">,</span>
                  <span class="token punctuation">)</span><span class="token punctuation">,</span>
                  <span class="token function">RaisedButton</span><span class="token punctuation">(</span>
                    onPressed<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                      _textViewController<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>_textEditController<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    child<span class="token punctuation">:</span> <span class="token function">Text</span><span class="token punctuation">(</span><span class="token string">'Set text'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  <span class="token punctuation">)</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">Container</span><span class="token punctuation">(</span>
              height<span class="token punctuation">:</span> <span class="token number">100.0</span><span class="token punctuation">,</span>
              alignment<span class="token punctuation">:</span> Alignment<span class="token punctuation">.</span>center<span class="token punctuation">,</span>
              color<span class="token punctuation">:</span> Colors<span class="token punctuation">.</span>blueAccent<span class="token punctuation">,</span>
              child<span class="token punctuation">:</span> <span class="token function">SizedBox</span><span class="token punctuation">(</span>
                child<span class="token punctuation">:</span> <span class="token function">TextView</span><span class="token punctuation">(</span>
                  <span class="token string">'Default Text'</span><span class="token punctuation">,</span>
                  onCreated<span class="token punctuation">:</span> <span class="token punctuation">(</span>TextViewController controller<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    _textViewController <span class="token operator">=</span> controller<span class="token punctuation">;</span>
                  <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
              <span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ส่วนที่ควรสนใจจาก Example ก็คือ ส่วนของการเรียกใช้งาน Widget TextView ที่ผมสร้างไว้</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token function">TextView</span><span class="token punctuation">(</span>
  <span class="token string">'Default Text'</span><span class="token punctuation">,</span>
  onCreated<span class="token punctuation">:</span> <span class="token punctuation">(</span>TextViewController controller<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _textViewController <span class="token operator">=</span> controller<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre></div><p>และ การสั่ง setText เมื่อผู้ใช้กดปุ่ม</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token function">RaisedButton</span><span class="token punctuation">(</span>
  onPressed<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _textViewController<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>_textEditController<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  child<span class="token punctuation">:</span> <span class="token function">Text</span><span class="token punctuation">(</span><span class="token string">'Set text'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre></div><div class="tip custom-block"><p>เราสามารถกำหนดขนาดของ <strong>PlatformView</strong> ที่เราสร้างได้โดยการครอบมันด้วย <strong>SizedBox</strong> หรือ <strong>Container</strong> ครับ</p></div> <center class="medium-zoom"><div class="force-max" style="max-width:50%;"><img src="/assets/img/08.96288f93.png" alt="Title"></div> <div class="caption">เมื่อเปิดมาก็จะเห็น TextView ของผมแสดงออกมาแล้ว</div></center> <center class="medium-zoom"><div class="force-max" style="max-width:50%;"><img src="/assets/img/09.f5c638a7.png" alt="Title"></div> <div class="caption">ลองพิมพ์ค่าใหม่แล้วกด Set Text ดู ค่าก็เปลี่ยนได้อย่างถูกต้อง</div></center> <h2 id="เอา-plugin-มาใช้งานจริง"><a href="#เอา-plugin-มาใช้งานจริง" class="header-anchor">#</a> เอา Plugin มาใช้งานจริง</h2> <p>ในโปรเจคที่เราต้องการใช้งานนั้น เราแค่เพิ่ม dependencies ในไฟล์ <code>pubspec.yaml</code> ก็ได้แล้วครับ</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">dependencies</span><span class="token punctuation">:</span>
  <span class="token key atrule">textview</span><span class="token punctuation">:</span>
    <span class="token key atrule">path</span><span class="token punctuation">:</span> ./path/to/plugin/root
</code></pre></div><p>ดาวน์โหลด Source Code <a href="https://github.com/aliceblock/textview" target="_blank" rel="noopener noreferrer">ที่นี่<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="สรุป"><a href="#สรุป" class="header-anchor">#</a> สรุป</h2> <p>อาจจะงงๆหน่อยนะครับ แต่ในหลายๆส่วนถ้าเราเคยเขียนสักครั้งนึงแล้ว การทำครั้งถัดๆไปจะไม่ยากครับเพราะมันเหมือนกันแทบจะหมดเลย
ถ้าหากมีข้อสงสัยอะไรสามารถติดต่อผ่าน <a href="https://facebook.com/intception" target="_blank" rel="noopener noreferrer">Facebook Page<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ของผมได้ครับ</p></div> <footer class="page-edit"><!----> <div data-href="https://blog.intception.me/dev/flutter/platform-view.html" data-width="100%" data-numposts="5" class="fb-comments" style="max-width:99%;"></div> <div class="last-updated"><span class="prefix">อัปเดตเมื่อ: </span> <span class="time">1 ปีที่แล้ว</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/dev/flutter/simple-plugin.html" class="prev">
          เขียน Native มาใช้บน Flutter
        </a></span> <!----></p></div> </main></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e8816fbe.js" defer></script><script src="/assets/js/23.98f77880.js" defer></script><script src="/assets/js/2.5511de28.js" defer></script><script src="/assets/js/9.3d2ae7fe.js" defer></script><script src="/assets/js/30.ceffa3ae.js" defer></script><script src="/assets/js/29.6bb21054.js" defer></script><script src="/assets/js/41.a1cbfaa2.js" defer></script>
  </body>
</html>
